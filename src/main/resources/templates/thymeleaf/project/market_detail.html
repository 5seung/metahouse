<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layout/salesLayout}">
<head>
<meta charset="UTF-8">

<title>project/detail</title>
<link href="/metahaus/css/project/market_product_detail.css" rel="stylesheet" type="text/css" />
<link href="/metahaus/css/project/market_product_detail_img.css" rel="stylesheet" type="text/css" /></head>
<body>
	<div layout:fragment="content" class="content">	
		<!-- product detail -->
		<div id="product_detail">
			<div>PROJECT&ensp;&rang;&ensp;
				<span th:text="${pjtInfo.category1}"></span>&ensp;&rang;&ensp;
				<span th:text="${pjtInfo.category2_pj}"></span>
			</div><br>
			<div id="main_title" th:text="${pjtInfo.title}"></div>
			<!-- 이미지 갤러리 -->
			<div id="photo_container">
				<div id="main_photo_box">
					<img th:src="@{/upload/project_thumbnail_img/}+${pjtInfo.project_thumbnail_img}" alt="photo" id="photo">
				</div>
 				<ul id="gallery" th:if="${projectImg != null}">
					<li>
						<img th:src="@{/upload/project_thumbnail_img/}+${pjtInfo.project_thumbnail_img}" alt="photo" id="photo">
					</li>
					<li th:each="Img:${projectImg}">
						<img th:src="@{/upload/project_thumbnail_img/}+${Img.project_store_filename}" alt="photo" id="photo">
					</li>
				</ul>
			</div>
			<!-- 컨텐츠 설명 -->
			<div class="sub_title" id="product_explain">서비스 설명</div>
			<div class="sub_content" th:utext="${pjtInfo.description}"></div>
			<!-- 가격 -->
			<div class="sub_title" id="price_explain">가격 정보</div>
			<div class="sub_content">
				<!-- 단일 패키지 -->
				<table class="price_table" id="one-level-price" 
						th:if="${pjtInfo.pjtSingle != null}">
					<tr>
						<th  colspan="2" th:text="'BASIC&ensp;&ensp;'+${pjtInfo.pjtSingle.price}+'원'"></th>
						<th></th>
					</tr>
					<tr> <!-- 첫번째 줄 시작 -->
					    <td>제목</td>
					    <td th:text="${pjtInfo.pjtSingle.pkg_title}"></td>
					</tr> <!-- 첫번째 줄 끝 -->
					<tr> <!-- 두번째 줄 시작 -->
					    <td>설명</td>
					    <td th:utext="${pjtInfo.pjtSingle.pkg_description}"></td>
					</tr>
					<tr> <!-- 세번째 줄 시작 -->
					    <td>작업일</td>
					    <td th:text="${pjtInfo.pjtSingle.workdays}+'일'"></td>
					</tr>
				</table> <!-- 단일패키지 끝 -->
				<!-- 3단 패키지 -->
				<table class="price_table" id="tri-level-price"
						th:if="${pjtInfo.pjtTriple != null}">
					<tr>
						<th></th>
						<th th:utext="'BASIC<br>'+${pjtInfo.pjtTriple.basic_price}+'원'"></th>
						<th th:utext="'ECONOMY<br>'+${pjtInfo.pjtTriple.economy_price}+'원'"></th>
						<th th:utext="'PREMIUM<br>'+${pjtInfo.pjtTriple.premium_price}+'원'"></th>
					</tr>
					<tr> <!-- 첫번째 줄 시작 -->
					    <td class="td1">제목</td>
					    <td class="td2" th:text="${pjtInfo.pjtTriple.basic_pkg_title}"></td>
					    <td class="td3" th:text="${pjtInfo.pjtTriple.economy_pkg_title}"></td>
					    <td class="td4" th:text="${pjtInfo.pjtTriple.premium_pkg_title}"></td>
					</tr> <!-- 첫번째 줄 끝 -->
					<tr> <!-- 두번째 줄 시작 -->
					    <td class="td1">설명</td>
					    <td class="td2" th:text="${pjtInfo.pjtTriple.basic_pkg_description}"></td>
					    <td class="td3" th:text="${pjtInfo.pjtTriple.economy_pkg_description}"></td>
					    <td class="td4" th:text="${pjtInfo.pjtTriple.premium_pkg_description}"></td>
					</tr>
					<tr> <!-- 세번째 줄 시작 -->
					    <td class="td1">작업일</td>
					    <td class="td2" th:text="${pjtInfo.pjtTriple.basic_workdays}+'일'"></td>
					    <td class="td3" th:text="${pjtInfo.pjtTriple.economy_workdays}+'일'"></td>
					    <td class="td4" th:text="${pjtInfo.pjtTriple.premium_workdays}+'일'"></td>
					</tr>
				</table> <!-- 3단 패키지 -->
			</div>
			<!-- 추가옵션 -->
			<div class="sub_title">추가옵션</div>
			<div class="sub_content">
				<table th:if="${projectOption.size > 0}">
					<tr class="product_option" th:each="option : ${projectOption}">
						<td th:text="'&diams;&ensp;'+${option.add_option_name}"></td>
						<td th:text="${option.add_option_description}"></td>
						<td th:text="${option.add_option_price}+'원 추가'"></td>
					</tr>
				</table>
				<div th:if="${projectOption.size <= 0}">
					<div>추가 옵션이 없습니다.</div>
				</div>
			</div>
            <!-- 취소 및 환불 규정 -->
            <div class="sub_title">취소 및 환불 규정</div>
            <div class="sub_content">
            	1. 기본 환불 규정<br/>
            	&ensp;1) 전문가와 의뢰인의 상호 협의하에 청약 철회 및 환불이 가능합니다.<br/>
            	&ensp;2) 작업이 완료된 이후 또는 자료, 프로그램 등 서비스가 제공된 이후에는 환불이 불가합니다.<br/><br/>
            	2. 판매자 책임 사유<br/>
            	&ensp;1) 판매자의 귀책사유로 당초 약정했던 서비스 미이행 혹은 보편적인 관점에서 심각하게 잘못 이행한 경우 결제한 금액에 대하여 전액 환불이 가능합니다.
            	<br/><br/>&lowast;추가 관련 규정은 당사 홈페이지의 최소 및 환불관련 규정을 참고해 주십시오.
            </div>

           <!-- 리뷰 -->
            <div class="sub_title">서비스 평가</div>
            <div class="sub_content" th:if="${projectReview.size > 0}">
            	<!-- 종합리뷰 -->
	            <div class="review_summary">
	            	<div class="review_avg" th:text="${#numbers.formatDecimal(#aggregates.sum(projectReview.![rating])*1.0/#lists.size(projectReview), 1, 1)}">
	            	</div>
	            	<div>
						<!-- 별점 -->
						<div class="reviewer_star_rating">
							<div class="star-ratings">
								<div class="star-ratings-fill space-x-2 text-lg"
								    :style="{ width: ratingToPercent + '%' }">
								    <th:block>
										<span>★ </span>
								    </th:block>
								</div>
								<div class="star-ratings-base space-x-2 text-lg">
									<span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
								</div>
							</div>
						</div>
	            		<!-- 리뷰갯수 -->
						<div th:text="${#lists.size(projectReview)+'개의 서비스 후기'}"></div>
	            	</div>
	            </div>
	            <hr/>
	            <!-- 리뷰 이미지 -->
				<div th:if="${ReviewImg.size > 0}">
					<div class="review_title">포토 후기</div>				
					<div class="banner-slider-wrap">
						<th:block th:if="${ReviewImg.size > 4}">
							<div class="btn-shape prebtn" onclick='pre(this)'>◀</div>
							<div class="btn-shape nextbtn" onclick='next(this)'>▶</div>		
						</th:block>
						<div class="slider-outter">
							<div index="0" class="banner-slider-list">
								<div th:each="reviewImg : ${ReviewImg}" class="banner-slider-item">
									<div class="review_photos item-img-warp" >
										<img  width=100% height=100% alt="리뷰이미지" th:src="@{/upload/review/project/}+${reviewImg.review_store_filename}"	
										 class="review_photo" style="background-color: pink;">
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
	
				<div class="review_title">서비스 후기</div>
				<!-- 개인 리뷰 -->
				<div class="review-wrap" th:each="review : ${projectReview}">
					<div class="reviewer" th:text="${review.writer_id}"></div>
					<div class="review_info_wrap">
						<!-- 개인리뷰 별점 -->
						<div class="reviewer_star_rating">
							<div class="star-ratings">
								<div class="star-ratings-fill space-x-2 text-lg"
									 :style="{ width: ratingToPercent + '%' }">
									<th:block th:each="num : ${#numbers.sequence(0,review.rating-1)}">
										<span>★</span>
									</th:block>
								</div>
								<div class="star-ratings-base space-x-2 text-lg">
									<span>★</span><span>★</span><span>★</span><span>★</span><span>★</span>
								</div>
							</div>
						</div>
						<!-- 개인 리뷰점수 -->
						<div th:text="'&ensp;'+${#numbers.formatDecimal(review.rating,1,1)}+'&ensp;'"></div>
						<!-- 개인 리뷰등록일자 -->
						<div class="reviewer" th:text="'|&ensp;'+${#dates.format(review.review_date,'yyyy.MM.dd')}"></div>
					</div>
					<br/>
					<!-- 개인 리뷰 내용 -->
					<div class="review_content" th:text="${review.review_text}"></div>
					
					<!-- 답글 섹션 -->
					<div class="comment speech-bubble" th:if="${review.reviewComment!=null}">
						<div>크리에이터<span th:text="'&ensp;|&ensp;'+${#dates.format(review.reviewComment.comment_date,'yyyy.MM.dd')}"></span></div><br>
						<div th:text="${review.reviewComment.comment_text}"></div>
					</div>
				</div>				
            </div>
            <!-- 리뷰없을 때 -->
            <div class="sub_content" th:if="${projectReview.size <= 0}">
	            <div class="review_summary">
					<div> 아직 등록된 리뷰가 없습니다.</div>
	            </div>
	        </div>
	           
            <!-- 게시글 신고 -->
            <div id="report">
				<img alt="신고아이콘" src="/metahaus/images/report_icon.png" id="report_img">
				<a>&ensp;게시글 신고하기</a>
			</div>
		</div>

		<!-- select_product_box -->
		<div id="select_product_box">
			<!-- select product -->
			<div id="select_product">
				<img alt="상품대표이미지" th:src="@{/upload/project_thumbnail_img/}+${pjtInfo.project_thumbnail_img}" id="represent_img">
				<div class="product_title" th:text="${pjtInfo.title}"></div>
				<div class="product_info" id="product_date" th:text="'작성일자:&ensp;'+${#dates.format(pjtInfo.project_date,'yyyy.MM.dd')}"></div>
				<th:block th:if="${pjtInfo.pjtSingle != null}">
				<div class="product_info" id="product_price" th:text="${pjtInfo.pjtSingle.price}+'원&ensp;~'"></div>
				</th:block>
				<th:block th:if="${pjtInfo.pjtTriple != null}">
				<div class="product_info" id="product_price" th:text="${pjtInfo.pjtTriple.basic_price}+'원&ensp;~'"></div>
				</th:block>
			</div>
			<!-- seller profile -->
			<div id="seller_profile" th:onclick="|location.href='@{/user/profile(userId=${pjtInfo.creator_id})}'|">
				<div id="seller_img_box">
					<th:block th:if="${pjtInfo.creator.thumbnailStoreFilename !=null}">
					<img alt="프로필 이미지" th:src="@{/upload/project_thumbnail_img/}+${pjtInfo.creator.thumbnailStoreFilename}" id="seller_img">
					</th:block>
					<th:block th:if="${pjtInfo.creator.thumbnailStoreFilename == null}">
					<img alt="프로필 이미지" src="/metahaus/images/test_img.jpg" id="seller_img">
					</th:block>
				</div>
				<div id="seller_info">
					<div class="seller_name" th:text="${pjtInfo.creator_id}">
					<div class="seller_name" th:text="${pjtInfo.creator.userName}"></div>
					</div>
				</div>
			</div>
			<!-- buy button -->
			<div id="btn">
				<button class="button--small btn_custom">문의하기</button>
				<button class="button--small btn_custom"
				th:onclick="|location.href='@{/project/purchase(projectNum=${pjtInfo.project_id})}'|">구매하기</button>
			</div>
		</div>
	<script src="/metahaus/js/project/market_detail.js"></script>
	</div><!-- layout:fragment -->	
	

</body>
</html>